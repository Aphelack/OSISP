# Системное программирование
## Л.р.5. Взаимодействие процессов: обмен данными

### Цель:
Изучение подходов, системных объектов и функций для обеспечения передачи данных между взаимодействующими процессами и/или совместной их обработки.

---

## Выполненные задания

### ✅ Задание 4: Сервер логирования
**Статус:** Выполнено

**Описание:** Многопользовательский сервер логирования с мультиплексированным вводом. Сервер принимает сообщения от нескольких клиентов через именованные каналы (Named Pipes), добавляет временные метки и идентификаторы источников, записывает в централизованный лог-файл.

**Архитектура:**
- **Сервер:** Создаёт именованный канал, принимает множественные подключения, каждому клиенту выделяет отдельный поток-обработчик
- **Клиенты:** Подключаются к каналу, отправляют серии сообщений, получают подтверждения
- **Синхронизация:** Critical Section для thread-safe записи в файл

**IPC механизм:** Named Pipes (message-oriented, duplex)

**Особенности:**
- Поддержка до 10 одновременных клиентов
- Временные метки с миллисекундной точностью
- Thread-safe логирование
- Автоматическая обработка подключений/отключений
- Формат: `[timestamp] [Client-ID] message`

**Расположение:** `task4_log_server/`

**Запуск:**
```bash
cd task4_log_server
./run_demo.sh              # Автоматическая демонстрация с 3 клиентами

# Или вручную:
wine log_server.exe        # Терминал 1: сервер
wine log_client.exe 1 5 500  # Терминал 2: клиент (ID, кол-во сообщений, задержка)
```

**Подробности:** См. [task4_log_server/README.md](task4_log_server/README.md)

---

### Ключевые концепции

#### IPC (Inter-Process Communication)
- Named Pipes - именованные каналы
- Message-oriented communication
- Множественные экземпляры канала
- Двунаправленный обмен

#### Многопоточность и синхронизация
- Отдельный поток для каждого клиента
- Critical Section для защиты общих ресурсов
- Thread-safe запись в файл
- Graceful shutdown

#### Мультиплексирование
- Один сервер обслуживает множество клиентов
- Параллельная обработка запросов
- Упорядоченное логирование

### Анализ корректности

✅ **Отсутствие коллизий:**
- Critical Section предотвращает race conditions
- Атомарные операции записи
- Нет перемешивания данных

✅ **Упорядоченность:**
- Временные метки отражают реальный порядок событий
- Лог показывает чередование сообщений от разных клиентов

✅ **Эффективность Named Pipes:**
- Низкая латентность (локальные pipes)
- Нативный Windows механизм
- Эффективная буферизация

### Практическая ценность

Реализация демонстрирует фундаментальные концепции:
- Централизованное логирование (как в syslog/journald)
- IPC между процессами через Named Pipes
- Многопоточное серверное программирование
- Синхронизация доступа к общим ресурсам

Аналогичные архитектуры используются в production системах для логирования, мониторинга и межпроцессного взаимодействия.

---

## Варианты заданий

### 1. Моделирование распределенной обработки (вычислений)

**Процессы двух видов:**

**Процесс-диспетчер:**
- Создание рабочих процессов и объектов IPC (каналов) для взаимодействия с ними
- Выдача «заданий» рабочим процессам
- Сбор результатов

**Рабочий процесс:**
- Прием «задания»
- Выполнение (обработка данных)
- Возврат результата

**Варианты обработки:**
- Статистические расчеты
- Сортировка
- Поиск
- Криптография
- Арифметические операции над большим объемом данных (матричные операции)

**Варианты используемых IPC:**
- Именованные и неименованные каналы
- Почтовые ящики
- Очереди сообщений

**Варианты конфигурации комплекса:**
- Отдельный канал для каждого рабочего процесса
- Один канал выдачи заданий и один канал приема для всех рабочих процессов
- Единый мультиплексированный канал

### 2. Моделирование конвейерной обработки

**Архитектура:** Программная модель системы массового обслуживания

**Состав:** Два или более (до 4-5) процессов, соответствующих «ступеням» обработки

**Принцип:** Передача обслуживаемых «заявок» по цепочке конвейера

**Варианты обработки:**
- Статистические расчеты
- Сортировка
- Поиск
- Криптография
- Математические вычисления

**Варианты используемых IPC:**
- Именованные и неименованные каналы
- Почтовые ящики
- Очереди сообщений

**Варианты организации цепочек (конвейеров):**
- Генерация блоков данных → обработка → визуализация
- Генерация блоков → сортировка → сборка → вывод
- Генерация блоков → шифрование → вывод → дешифрование → вывод

### 3. Организация обмена через разделяемую память

**Принцип:** Совместное использование содержимого разделяемой памяти несколькими процессами (потоками) с предотвращением коллизий

**Пример архитектуры комплекса:**
- Пул буферов в памяти
- Передача буферов между процессами-«пользователями»
- Защита от коллизий семафорами (мьютексами)

**Процессы-«пользователи»:**
- Получение (захват) буфера
- Заполнение данными или обработка имеющегося содержимого
- Возврат в пул или адресная передача следующему процессу

### 4. «Сервер логирования»

**Назначение:** Реализация многопользовательского (с мультиплексированием) вывода

**Процесс-сервер:**
- Ожидание данных (сообщений) от нескольких источников (клиентов)
- Запись сообщений в файл с соблюдением порядка поступления
- Снабжение дополнительной информацией (временная метка, идентификатор источника)
- Соблюдение определенного формата

**Опциональные функции:**
- Управление файлом «журнала»
- Периодическое архивирование
- Перезапись

**Процессы-клиенты:** Тестово-демонстрационный функционал - передача сгенерированных сообщений серверу для их протоколирования

**Варианты используемых IPC:**
- Именованные и неименованные каналы
- Почтовые ящики
- Очереди сообщений

### 5. Интерактивное взаимодействие пользователей («чат»)

**Назначение:** Упрощенный чат для нескольких пользователей

**Процесс-сервер:**
- Создание необходимых для общения с клиентами IPC
- Прием и временное хранение сообщений
- Передача сообщений адресно одному или нескольким клиентам

**Процесс-клиент:**
- Соединение с сервером
- Ввод пользовательских сообщений и передача их серверу
- Прием и отображение сообщений от сервера

**Требования к разработке:**
- Структура передаваемых сообщений (адрес и тело сообщения)
- Порядок обмена (протокол прикладного уровня)

**Варианты используемых IPC:**
- Именованные и неименованные каналы
- Почтовые ящики
- Очереди сообщений

### 6. ...
...